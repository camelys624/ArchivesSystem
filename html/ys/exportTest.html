<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>导出测试</title>
    <script type="text/javascript" src="../../js/ys/xlsx/dist/jszip.js"></script>
    <script type="text/javascript" src="../../js/ys/xlsx/dist/xlsx.js"></script>
</head>
<body>
<button onclick="downloadExl(jsono)">导出</button>
</body>
<script type="text/javascript">
    function saveAs(obj, fileName) {//当然可以自定义简单的下载文件实现方式
        var tmpa = document.createElement("a");
        tmpa.download = fileName || "下载";
        tmpa.href = URL.createObjectURL(obj); //绑定a标签
        tmpa.click(); //模拟点击实现下载
        setTimeout(function () { //延时释放
            URL.revokeObjectURL(obj); //用URL.revokeObjectURL()来释放这个object URL
        }, 100);
    }

    var jsono = [{
        "rdTypeName": "科技档案",
        "arcName": "4156",
        "fkLocationId": 0,
        "rdLocationAddr": "0区0列0节0层右边",
        "araeRegion": {
            "id": 0,
            "quNumLeft": 1,
            "name": null,
            "capacity": null,
            "speed": 100,
            "width": 45,
            "ip": "192.168.1.1",
            "httpPort": 8081,
            "tcpPort": 0,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-20 10:36:39",
            "updateTime": "2018-08-28 00:00:00",
            "fkStoreId": 0,
            "rdStoreName": null,
            "quNumRigth": 0,
            "gdlType": 2,
            "cols": 7,
            "divs": 5,
            "lays": 7,
            "staticCol": 7,
            "ventgaps": null
        },
        "fkBoxId": 153492651458695,
        "updateTime": "2018-08-28 00:00:00",
        "archivesBarcode": "456",
        "araeLocation": {
            "id": 0,
            "fkRegionId": 0,
            "col": 0,
            "lay": 0,
            "div": 0,
            "rfid": "456",
            "localtion": 0,
            "fkStoreId": 0,
            "rdRegionNum": 0
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "456",
        "createTime": "2018-08-20 10:36:39",
        "details": "{\"3\": \"2018年8月20日\", \"57852\": \"456\", \"档号\": \"456\", \"题名\": \"4156\"}",
        "rfid": "456",
        "id": 153473259897238,
        "fkTypeId": 153451182657166,
        "status": 1,
        "LAY_TABLE_INDEX": 0
    }, {
        "rdTypeName": "科技档案",
        "arcName": "test3",
        "fkLocationId": 153544018029279,
        "rdLocationAddr": "1区9列1节9层左边",
        "araeRegion": {
            "id": 9,
            "quNumLeft": null,
            "name": "9号仓库",
            "capacity": 600,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": 32,
            "createTime": "2018-08-24 17:41:29",
            "updateTime": "2018-08-28 00:00:00",
            "fkStoreId": 9,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "fkBoxId": 153492651458695,
        "updateTime": "2018-08-28 00:00:00",
        "archivesBarcode": "12123",
        "araeLocation": {
            "id": 153544018029279,
            "fkRegionId": 9,
            "col": 9,
            "lay": 9,
            "div": 1,
            "rfid": "121",
            "localtion": 1,
            "fkStoreId": 9,
            "rdRegionNum": 1
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "231",
        "createTime": "2018-08-24 17:41:29",
        "details": "{\"档号\": \"231\", \"题名\": \"test3\"}",
        "rfid": "121",
        "id": 153510368935165,
        "fkTypeId": 153451182657166,
        "status": 1,
        "LAY_TABLE_INDEX": 1
    }, {
        "rdTypeName": "科技档案",
        "arcName": "test9",
        "fkLocationId": 153559451541795,
        "rdLocationAddr": "5区3列5节1层右边",
        "araeRegion": {
            "id": 15355070839896,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-30 10:01:56",
            "updateTime": null,
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "archivesBarcode": "009",
        "araeLocation": {
            "id": 153559451541795,
            "fkRegionId": 15355070839896,
            "col": 3,
            "lay": 1,
            "div": 5,
            "rfid": "009",
            "localtion": 2,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 5
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "009",
        "createTime": "2018-08-30 10:01:56",
        "details": "{\"档号\": \"009\", \"题名\": \"test9\"}",
        "rfid": "009",
        "id": 153559451560926,
        "fkTypeId": 153451182657166,
        "status": 3,
        "LAY_TABLE_INDEX": 2
    }, {
        "rdTypeName": "科技档案",
        "arcName": "test10",
        "fkLocationId": 153559467148453,
        "rdLocationAddr": "5区15列4节3层右边",
        "araeRegion": {
            "id": 15355070839896,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-30 10:04:32",
            "updateTime": null,
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "archivesBarcode": "010",
        "araeLocation": {
            "id": 153559467148453,
            "fkRegionId": 15355070839896,
            "col": 15,
            "lay": 3,
            "div": 4,
            "rfid": "010",
            "localtion": 2,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 5
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "010",
        "createTime": "2018-08-30 10:04:32",
        "details": "{\"档号\": \"010\", \"题名\": \"test10\"}",
        "rfid": "010",
        "id": 153559467150070,
        "fkTypeId": 153451182657166,
        "status": 3,
        "LAY_TABLE_INDEX": 3
    }, {
        "rdTypeName": "科技档案",
        "arcName": "22",
        "fkLocationId": 153544279391971,
        "rdLocationAddr": "2区0列2节1层右边",
        "araeRegion": {
            "id": 153542078202040,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-29 14:51:48",
            "updateTime": null,
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "archivesBarcode": "123",
        "araeLocation": {
            "id": 153544279391971,
            "fkRegionId": 153542078202040,
            "col": 0,
            "lay": 1,
            "div": 2,
            "rfid": "213",
            "localtion": 2,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 2
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "21",
        "createTime": "2018-08-29 14:51:48",
        "details": "{\"档号\": \"21\", \"题名\": \"22\"}",
        "rfid": "213",
        "id": 153552550816260,
        "fkTypeId": 153451182657166,
        "status": 2,
        "LAY_TABLE_INDEX": 4
    }, {
        "rdTypeName": "科技档案",
        "arcName": "test8",
        "fkLocationId": 153553663505245,
        "rdLocationAddr": "5区1列2节1层右边",
        "araeRegion": {
            "id": 15355070839896,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-29 14:42:53",
            "updateTime": "2018-08-29 00:00:00",
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "updateTime": "2018-08-29 00:00:00",
        "archivesBarcode": "22222",
        "araeLocation": {
            "id": 153553663505245,
            "fkRegionId": 15355070839896,
            "col": 1,
            "lay": 1,
            "div": 2,
            "rfid": "1111",
            "localtion": 2,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 5
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "232",
        "createTime": "2018-08-29 14:42:53",
        "details": "{\"档号\": \"232\", \"题名\": \"test8\"}",
        "rfid": "1111",
        "id": 153552497310943,
        "fkTypeId": 153451182657166,
        "status": 1,
        "LAY_TABLE_INDEX": 5
    }, {
        "rdTypeName": "科技档案",
        "arcName": "test6",
        "fkLocationId": 15355366657904,
        "rdLocationAddr": "5区1列1节3层左边",
        "araeRegion": {
            "id": 15355070839896,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-29 11:56:21",
            "updateTime": "2018-08-29 00:00:00",
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "fkBoxId": 153492651131692,
        "updateTime": "2018-08-29 00:00:00",
        "archivesBarcode": "2222",
        "araeLocation": {
            "id": 15355366657904,
            "fkRegionId": 15355070839896,
            "col": 1,
            "lay": 3,
            "div": 1,
            "rfid": "2222",
            "localtion": 1,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 5
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "231",
        "createTime": "2018-08-29 11:56:21",
        "details": "{\"档号\": \"231\", \"题名\": \"test6\"}",
        "rfid": "2222",
        "id": 153551498116274,
        "fkTypeId": 153451182657166,
        "status": 2,
        "LAY_TABLE_INDEX": 6
    }, {
        "rdTypeName": "科技档案",
        "arcName": "test5",
        "fkLocationId": 153544791450597,
        "rdLocationAddr": "1区0列1节4层左边",
        "araeRegion": {
            "id": 153510282438082,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-29 11:59:29",
            "updateTime": "2018-08-29 00:00:00",
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "fkBoxId": 153492651131692,
        "updateTime": "2018-08-29 00:00:00",
        "archivesBarcode": "111222",
        "araeLocation": {
            "id": 153544791450597,
            "fkRegionId": 153510282438082,
            "col": 0,
            "lay": 4,
            "div": 1,
            "rfid": "2121",
            "localtion": 1,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 1
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "232213",
        "createTime": "2018-08-29 11:59:29",
        "details": "\"{\\\"档号\\\": \\\"232213\\\", \\\"题名\\\": \\\"test5\\\"}\"",
        "rfid": "2121",
        "id": 153551516879172,
        "fkTypeId": 153451182657166,
        "status": 2,
        "LAY_TABLE_INDEX": 7
    }, {
        "rdTypeName": "科技档案",
        "arcName": "test4",
        "fkLocationId": 153544791450597,
        "rdLocationAddr": "1区0列1节4层左边",
        "araeRegion": {
            "id": 153510282438082,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-28 17:18:35",
            "updateTime": null,
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "archivesBarcode": "3232",
        "araeLocation": {
            "id": 153544791450597,
            "fkRegionId": 153510282438082,
            "col": 0,
            "lay": 4,
            "div": 1,
            "rfid": "1231",
            "localtion": 1,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 1
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "001",
        "createTime": "2018-08-28 17:18:35",
        "details": "{\"档号\": \"001\", \"题名\": \"test4\"}",
        "rfid": "1231",
        "id": 153544791473960,
        "fkTypeId": 153451182657166,
        "status": 2,
        "LAY_TABLE_INDEX": 8
    }, {
        "rdTypeName": "科技档案",
        "arcName": "12",
        "fkLocationId": 153544791450597,
        "rdLocationAddr": "1区0列1节4层左边",
        "araeRegion": {
            "id": 153510282438082,
            "quNumLeft": null,
            "name": "test1",
            "capacity": null,
            "speed": null,
            "width": null,
            "ip": null,
            "httpPort": null,
            "tcpPort": null,
            "videoIp": null,
            "tempture": null,
            "humi": null,
            "createTime": "2018-08-29 14:37:48",
            "updateTime": null,
            "fkStoreId": 153510277704725,
            "rdStoreName": null,
            "quNumRigth": null,
            "gdlType": null,
            "cols": null,
            "divs": null,
            "lays": null,
            "staticCol": null,
            "ventgaps": null
        },
        "archivesBarcode": "232",
        "araeLocation": {
            "id": 153544791450597,
            "fkRegionId": 153510282438082,
            "col": 0,
            "lay": 4,
            "div": 1,
            "rfid": "213",
            "localtion": 1,
            "fkStoreId": 153510277704725,
            "rdRegionNum": 1
        },
        "fkTemplateId": 153472951726331,
        "deleted": 0,
        "archivesNumber": "23",
        "createTime": "2018-08-29 14:37:48",
        "details": "{\"档号\": \"23\", \"题名\": \"12\"}",
        "rfid": "213",
        "id": 153552466784451,
        "fkTypeId": 153451182657166,
        "status": 3,
        "LAY_TABLE_INDEX": 9
    }];
    const wopts = {bookType: 'xlsx', bookSST: false, type: 'binary'};//这里的数据是用来定义导出的格式类型
    // const wopts = { bookType: 'csv', bookSST: false, type: 'binary' };//ods格式
    // const wopts = { bookType: 'ods', bookSST: false, type: 'binary' };//ods格式
    // const wopts = { bookType: 'xlsb', bookSST: false, type: 'binary' };//xlsb格式
    // const wopts = { bookType: 'fods', bookSST: false, type: 'binary' };//fods格式
    // const wopts = { bookType: 'biff2', bookSST: false, type: 'binary' };//xls格式

    function downloadExl(data, type) {
        const wb = {SheetNames: ['Sheet1'], Sheets: {}, Props: {}};
        wb.Sheets['Sheet1'] = XLSX.utils.json_to_sheet(data);//通过json_to_sheet转成单页(Sheet)数据
        saveAs(new Blob([s2ab(XLSX.write(wb, wopts))], {type: "application/octet-stream"}), "这里是下载的文件名" + '.' + (wopts.bookType == "biff2" ? "xls" : wopts.bookType));
    }

    function s2ab(s) {
        if (typeof ArrayBuffer !== 'undefined') {
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        } else {
            var buf = new Array(s.length);
            for (var i = 0; i != s.length; ++i) buf[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }
    }
</script>
</html>